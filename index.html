<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js Color Quiz</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.138.3/three.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #quiz-container {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            max-width: 300px;
            overflow-y: auto;
            max-height: 90vh;
        }
        label {
            display: block;
            margin-bottom: 10px;
        }
        button {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="quiz-container">
        <h3>Descubre tu color basado en tus temores</h3>
        <form id="quiz-form">
            <!-- (Formulario como estaba) -->
            <button type="submit">Descubrir mi color</button>
        </form>
    </div>
    <script>
        // Set up Three.js scene
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // Function to create different geometries based on RGB values
        function createGeometry(red, green, blue) {
            if (red > green && red > blue) {
                return new THREE.BoxGeometry(); // Cubo para rojo
            } else if (green > red && green > blue) {
                return new THREE.SphereGeometry(); // Esfera para verde
            } else {
                return new THREE.ConeGeometry(); // Cono para azul
            }
        }

        // Initial geometry and material
        let geometry = new THREE.BoxGeometry();
        const material = new THREE.MeshBasicMaterial({ color: 0x000000 }); // Default color: black
        let mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);

        // Position the camera
        camera.position.z = 5;

        // Animate the mesh (rotation)
        function animate() {
            requestAnimationFrame(animate);
            mesh.rotation.x += 0.01;
            mesh.rotation.y += 0.01;
            renderer.render(scene, camera);
        }
        animate();

        // Handle the quiz form
        document.getElementById('quiz-form').addEventListener('submit', (event) => {
            event.preventDefault();

            // Get the form data
            const formData = new FormData(event.target);
            const answers = Array.from(formData.values()).map(value => parseInt(value, 10));

            // Map answers to RGB values
            const red = Math.min(255, answers.slice(0, 7).reduce((acc, val) => acc + val * 10, 0)); // Sección 1
            const green = Math.min(255, answers.slice(7, 14).reduce((acc, val) => acc + val * 10, 0)); // Sección 2
            const blue = Math.min(255, answers.slice(14).reduce((acc, val) => acc + val * 10, 0)); // Sección 3

            // Convert RGB to Hex
            const colorHex = (red << 16) | (green << 8) | blue;

            // Remove the old mesh
            scene.remove(mesh);

            // Create new geometry based on RGB values
            geometry = createGeometry(red, green, blue);
            mesh = new THREE.Mesh(geometry, material);
            material.color.set(colorHex);
            scene.add(mesh);

            alert(`Tu color es: #${colorHex.toString(16).padStart(6, '0').toUpperCase()}`);
        });
    </script>
</body>
</html>
